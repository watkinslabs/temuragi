/*! For license information please see PurchaseOrderBuilder.bundle.js.LICENSE.txt */
!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports["user_components/PurchaseOrderBuilder"]=t():e["user_components/PurchaseOrderBuilder"]=t()}(self,()=>(()=>{"use strict";var e,t={165:(e,t,n)=>{n.d(t,{default:()=>T});var r=n(540),a=n(697),c=n(504),o=n(852),l=n(966),s=n(78),i=n(404),u=n(708);function m(e){return m="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},m(e)}function d(e){return function(e){if(Array.isArray(e))return _(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||N(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function p(){var e,t,n="function"==typeof Symbol?Symbol:{},r=n.iterator||"@@iterator",a=n.toStringTag||"@@toStringTag";function c(n,r,a,c){var s=r&&r.prototype instanceof l?r:l,i=Object.create(s.prototype);return f(i,"_invoke",function(n,r,a){var c,l,s,i=0,u=a||[],m=!1,d={p:0,n:0,v:e,a:p,f:p.bind(e,4),d:function(t,n){return c=t,l=0,s=e,d.n=n,o}};function p(n,r){for(l=n,s=r,t=0;!m&&i&&!a&&t<u.length;t++){var a,c=u[t],p=d.p,f=c[2];n>3?(a=f===r)&&(s=c[(l=c[4])?5:(l=3,3)],c[4]=c[5]=e):c[0]<=p&&((a=n<2&&p<c[1])?(l=0,d.v=r,d.n=c[1]):p<f&&(a=n<3||c[0]>r||r>f)&&(c[4]=n,c[5]=r,d.n=f,l=0))}if(a||n>1)return o;throw m=!0,r}return function(a,u,f){if(i>1)throw TypeError("Generator is already running");for(m&&1===u&&p(u,f),l=u,s=f;(t=l<2?e:s)||!m;){c||(l?l<3?(l>1&&(d.n=-1),p(l,s)):d.n=s:d.v=s);try{if(i=2,c){if(l||(a="next"),t=c[a]){if(!(t=t.call(c,s)))throw TypeError("iterator result is not an object");if(!t.done)return t;s=t.value,l<2&&(l=0)}else 1===l&&(t=c.return)&&t.call(c),l<2&&(s=TypeError("The iterator does not provide a '"+a+"' method"),l=1);c=e}else if((t=(m=d.n<0)?s:n.call(r,d))!==o)break}catch(t){c=e,l=1,s=t}finally{i=1}}return{value:t,done:m}}}(n,a,c),!0),i}var o={};function l(){}function s(){}function i(){}t=Object.getPrototypeOf;var u=[][r]?t(t([][r]())):(f(t={},r,function(){return this}),t),m=i.prototype=l.prototype=Object.create(u);function d(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,i):(e.__proto__=i,f(e,a,"GeneratorFunction")),e.prototype=Object.create(m),e}return s.prototype=i,f(m,"constructor",i),f(i,"constructor",s),s.displayName="GeneratorFunction",f(i,a,"GeneratorFunction"),f(m),f(m,a,"Generator"),f(m,r,function(){return this}),f(m,"toString",function(){return"[object Generator]"}),(p=function(){return{w:c,m:d}})()}function f(e,t,n,r){var a=Object.defineProperty;try{a({},"",{})}catch(e){a=0}f=function(e,t,n,r){if(t)a?a(e,t,{value:n,enumerable:!r,configurable:!r,writable:!r}):e[t]=n;else{var c=function(t,n){f(e,t,function(e){return this._invoke(t,n,e)})};c("next",0),c("throw",1),c("return",2)}},f(e,t,n,r)}function v(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function b(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?v(Object(n),!0).forEach(function(t){h(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):v(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function h(e,t,n){return(t=function(e){var t=function(e){if("object"!=m(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=m(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==m(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function y(e,t,n,r,a,c,o){try{var l=e[c](o),s=l.value}catch(e){return void n(e)}l.done?t(s):Promise.resolve(s).then(r,a)}function E(e){return function(){var t=this,n=arguments;return new Promise(function(r,a){var c=e.apply(t,n);function o(e){y(c,r,a,o,l,"next",e)}function l(e){y(c,r,a,o,l,"throw",e)}o(void 0)})}}function g(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,a,c,o,l=[],s=!0,i=!1;try{if(c=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;s=!1}else for(;!(s=(r=c.call(n)).done)&&(l.push(r.value),l.length!==t);s=!0);}catch(e){i=!0,a=e}finally{try{if(!s&&null!=n.return&&(o=n.return(),Object(o)!==o))return}finally{if(i)throw a}}return l}}(e,t)||N(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function N(e,t){if(e){if("string"==typeof e)return _(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?_(e,t):void 0}}function _(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}var x=function(e){var t=e.value,n=e.vendors,a=e.onVendorChange,c=e.api_call,o=e.disabled,l=g((0,r.useState)(""),2),s=l[0],i=l[1],u=g((0,r.useState)([]),2),m=u[0],d=u[1],f=g((0,r.useState)(!1),2),v=(f[0],f[1]),b=g((0,r.useState)(!1),2),h=b[0],y=b[1];if(n&&n.length>0)return r.createElement("select",{className:"form-select form-select-sm",value:t,onChange:function(){var e=E(p().m(function e(t){var n,r,o;return p().w(function(e){for(;;)switch(e.n){case 0:if(r=t.target.value){e.n=1;break}return e.a(2);case 1:return e.n=2,c("list","GPACIFIC_dbo_BKAPVEND",{filters:{code:{operator:"eq",value:r}},start:0,length:1});case 2:(o=e.v).success&&null!==(n=o.data)&&void 0!==n&&n[0]&&a(o.data[0]);case 3:return e.a(2)}},e)}));return function(t){return e.apply(this,arguments)}}(),disabled:o,required:!0},r.createElement("option",{value:""},"Select vendor..."),n.map(function(e){return r.createElement("option",{key:e.code,value:e.code},e.code," - ",e.company)}));var N=function(){var e=E(p().m(function e(t){var n;return p().w(function(e){for(;;)switch(e.n){case 0:if(!(t.length<2)){e.n=1;break}return d([]),e.a(2);case 1:return v(!0),e.n=2,c("list","GPACIFIC_dbo_BKAPVEND",{filters:{name:{operator:"ilike",value:t}}});case 2:(n=e.v).success&&n.data&&d(n.data.slice(0,10)),v(!1);case 3:return e.a(2)}},e)}));return function(t){return e.apply(this,arguments)}}();return(0,r.useEffect)(function(){var e=setTimeout(function(){s&&!t&&N(s)},300);return function(){return clearTimeout(e)}},[s]),r.createElement("div",{className:"position-relative"},r.createElement("input",{type:"text",className:"form-control form-control-sm",value:t?"".concat(t," - ").concat(s):s,onChange:function(e){i(e.target.value),y(!0)},onFocus:function(){return y(!0)},onBlur:function(){return setTimeout(function(){return y(!1)},200)},placeholder:"Search vendor...",disabled:o,required:!0}),h&&m.length>0&&r.createElement("div",{className:"position-absolute top-100 start-0 w-100 bg-white border rounded shadow-sm mt-1",style:{maxHeight:"200px",overflowY:"auto",zIndex:1050}},m.map(function(e){return r.createElement("div",{key:e.code,className:"p-2 hover-bg-light cursor-pointer",onClick:function(){a(e),i(e.name),y(!1)}},e.code," - ",e.name)})))},w=function(e){var t=e.value,n=e.onChange,a=e.api_call,c=e.disabled,o=g((0,r.useState)([]),2),l=o[0],s=o[1];return(0,r.useEffect)(function(){var e=function(){var e=E(p().m(function e(){var t;return p().w(function(e){for(;;)switch(e.n){case 0:return e.n=1,a("list","BKSYSTERM",{start:0,length:0,return_columns:["num","desc"],order:[{column:0,dir:"asc"}],columns:[{name:"num"},{name:"desc"}]});case 1:(t=e.v).success&&t.data&&s(t.data);case 2:return e.a(2)}},e)}));return function(){return e.apply(this,arguments)}}();e()},[]),r.createElement("select",{className:"form-select form-select-sm",value:t,onChange:function(e){return n(e.target.value)},disabled:c},r.createElement("option",{value:""},"Select Terms..."),l.map(function(e){return r.createElement("option",{key:e.num,value:e.num},e.desc)}))},C=function(e){var t=e.value,n=e.onChange,a=e.api_call,c=e.company,o=g((0,r.useState)([]),2),l=o[0],s=o[1];return(0,r.useEffect)(function(){var e=function(){var e=E(p().m(function e(){var t;return p().w(function(e){for(;;)switch(e.n){case 0:return e.n=1,a("list","JADVDATA_dbo_locations",{start:0,length:0,return_columns:["location","location_name"],order:[{column:1,dir:"asc"}],columns:[{name:"location"},{name:"location_name"}],filters:{company:{operator:"eq",value:c||"PACIFIC"},warehouse:{operator:"eq",value:"1"},active:{operator:"eq",value:"1"}}});case 1:(t=e.v).success&&t.data&&s(t.data);case 2:return e.a(2)}},e)}));return function(){return e.apply(this,arguments)}}();e()},[]),r.createElement("select",{className:"form-select form-select-sm",value:t,onChange:function(e){return n(e.target.value)}},r.createElement("option",{value:""},"Select Location..."),l.map(function(e){return r.createElement("option",{key:e.location,value:e.location},e.location," - ",e.location_name)}))},S=function(e){var t=e.value,n=e.onChange,a=(e.api_call,e.disabled),c=g((0,r.useState)([]),2),o=(c[0],c[1],g((0,r.useState)(!1),2)),l=o[0],s=o[1];return r.createElement("div",{className:"position-relative"},r.createElement("input",{type:"text",className:"form-control form-control-sm",value:t,onChange:function(e){return n(e.target.value)},onFocus:function(){return s(!0)},onBlur:function(){return setTimeout(function(){return s(!1)},200)},placeholder:"Ship via...",disabled:a}),l&&r.createElement("div",{className:"position-absolute top-100 start-0 w-100 bg-white border rounded shadow-sm mt-1",style:{zIndex:1050}},["UPS","FEDEX","USPS","DHL","FREIGHT","PICKUP"].filter(function(e){return e.toLowerCase().includes(t.toLowerCase())}).map(function(e){return r.createElement("div",{key:e,className:"p-2 hover-bg-light cursor-pointer",onClick:function(){n(e),s(!1)}},e)})))},k=function(e){var t=e.title,n=e.address,a=e.onChange,c=e.readonly,o=e.showCopyButton,l=e.onCopy;return r.createElement("div",{className:"card h-100"},r.createElement("div",{className:"card-header d-flex justify-content-between align-items-center"},r.createElement("h6",{className:"mb-0"},t),o&&r.createElement("button",{type:"button",className:"btn btn-sm btn-secondary",onClick:l},r.createElement(i.A,{size:14,className:"me-1"}),"Copy from Billing")),r.createElement("div",{className:"card-body"},r.createElement("div",{className:"row g-2"},r.createElement("div",{className:"col-12"},r.createElement("input",{type:"text",className:"form-control form-control-sm",value:n.name,onChange:function(e){return a(b(b({},n),{},{name:e.target.value}))},placeholder:"Company Name",readOnly:c})),"Shipping Address"===t&&r.createElement("div",{className:"col-12"},r.createElement("input",{type:"text",className:"form-control form-control-sm",value:n.attention||"",onChange:function(e){return a(b(b({},n),{},{attention:e.target.value}))},placeholder:"Attention"})),r.createElement("div",{className:"col-12"},r.createElement("input",{type:"text",className:"form-control form-control-sm",value:n.address1,onChange:function(e){return a(b(b({},n),{},{address1:e.target.value}))},placeholder:"Address Line 1",readOnly:c})),r.createElement("div",{className:"col-12"},r.createElement("input",{type:"text",className:"form-control form-control-sm",value:n.address2,onChange:function(e){return a(b(b({},n),{},{address2:e.target.value}))},placeholder:"Address Line 2",readOnly:c})),r.createElement("div",{className:"col-6"},r.createElement("input",{type:"text",className:"form-control form-control-sm",value:n.city,onChange:function(e){return a(b(b({},n),{},{city:e.target.value}))},placeholder:"City",readOnly:c})),r.createElement("div",{className:"col-2"},r.createElement("input",{type:"text",className:"form-control form-control-sm",value:n.state,onChange:function(e){return a(b(b({},n),{},{state:e.target.value}))},placeholder:"ST",maxLength:"2",readOnly:c})),r.createElement("div",{className:"col-4"},r.createElement("input",{type:"text",className:"form-control form-control-sm",value:n.zip,onChange:function(e){return a(b(b({},n),{},{zip:e.target.value}))},placeholder:"ZIP",readOnly:c})))))},O=function(e){var t=e.line,n=e.index,a=e.onUpdate,c=e.onRemove,o=e.api_call,l=e.virtualInventory,s=e.inventoryLoading,i=e.onFetchInventory,m=e.onSelectVendor,d=parseFloat(t.rqty||0)>0,f="historical"===t._source,v=d||f,b=n+1;return"N"===t.type||!t.pcode&&!t.part&&t.msg?r.createElement("div",{className:"card mb-2 ".concat(v?"bg-light":"")},r.createElement("div",{className:"card-body"},r.createElement("div",{className:"row align-items-center"},r.createElement("div",{className:"col-auto"},r.createElement("span",{className:"fw-bold text-muted"},"Line ",b),d&&r.createElement("span",{className:"badge bg-success ms-2"},"RECEIVED")),r.createElement("div",{className:"col-auto"},r.createElement("span",{className:"badge bg-info"},"NOTE")),r.createElement("div",{className:"col"},r.createElement("input",{type:"text",className:"form-control form-control-sm",value:t.message||t.msg||"",onChange:function(e){return a(n,"message",e.target.value)},maxLength:"30",placeholder:"Note (max 30 characters)",readOnly:v})),!v&&r.createElement("div",{className:"col-auto"},r.createElement("button",{className:"btn btn-sm btn-danger",onClick:function(){return c(n)}},r.createElement(u.A,{size:16})))))):r.createElement("div",{className:"card mb-2 ".concat(v?"bg-light":"")},r.createElement("div",{className:"card-body"},r.createElement("div",{className:"d-flex justify-content-between align-items-center mb-2"},r.createElement("div",null,r.createElement("span",{className:"fw-bold text-muted"},"Line ",b),d&&r.createElement("span",{className:"badge bg-success ms-2"},"RECEIVED")),!v&&r.createElement("button",{className:"btn btn-sm btn-danger",onClick:function(){return c(n)}},r.createElement(u.A,{size:16}))),r.createElement("div",{className:"row g-2"},r.createElement("div",{className:"col-md-2"},r.createElement("label",{className:"form-label small mb-1"},"Part #"),r.createElement(A,{value:t.part||t.pcode||"",onChange:function(e){return a(n,"part",e)},onPartSelect:function(){var e=E(p().m(function e(t){var r,c;return p().w(function(e){for(;;)switch(e.n){case 0:return a(n,"part",t.part),a(n,"description",t.inventory_description),e.n=1,o("list","GPACIFIC_dbo_BKICMSTR",{return_columns:["code","lstc"],order:[{column:0,dir:"asc"}],columns:[{name:"code"},{name:"lstc"}],start:0,length:1,filters:{code:{operator:"eq",value:t.part}}});case 1:(c=e.v).success&&null!==(r=c.data)&&void 0!==r&&r[0]&&a(n,"price",c.data[0].lstc||0),i(t.part);case 2:return e.a(2)}},e)}));return function(t){return e.apply(this,arguments)}}(),api_call:o,readonly:v})),r.createElement("div",{className:"col-md-4"},r.createElement("label",{className:"form-label small mb-1"},"Description"),r.createElement("input",{type:"text",className:"form-control form-control-sm",value:t.description||t.pdesc||"",onChange:function(e){return a(n,"description",e.target.value)},placeholder:"Part description",readOnly:v})),r.createElement("div",{className:"col-md-1"},r.createElement("label",{className:"form-label small mb-1"},"Qty"),r.createElement("input",{type:"number",className:"form-control form-control-sm",value:t.quantity||t.pqty||0,onChange:function(e){return a(n,"quantity",parseFloat(e.target.value)||0)},min:"0",step:"1",readOnly:v})),r.createElement("div",{className:"col-md-1"},r.createElement("label",{className:"form-label small mb-1"},"Price"),r.createElement("input",{type:"number",className:"form-control form-control-sm",value:t.price||t.pprce||0,onChange:function(e){return a(n,"price",parseFloat(e.target.value)||0)},min:"0",step:"0.01",readOnly:v})),r.createElement("div",{className:"col-md-1"},r.createElement("label",{className:"form-label small mb-1"},"Disc"),r.createElement("input",{type:"number",className:"form-control form-control-sm",value:t.discount||t.pdisc||0,onChange:function(e){return a(n,"discount",parseFloat(e.target.value)||0)},min:"0",readOnly:v})),r.createElement("div",{className:"col-md-1"},r.createElement("label",{className:"form-label small mb-1"},"Extended"),r.createElement("input",{type:"text",className:"form-control form-control-sm",value:"$".concat((t.extended||t.pext||0).toFixed(2)),readOnly:!0})),r.createElement("div",{className:"col-md-2"},r.createElement("label",{className:"form-label small mb-1"},"Expected Date"),r.createElement("input",{type:"date",className:"form-control form-control-sm",value:t.erd||"",onChange:function(e){return a(n,"erd",e.target.value)},readOnly:v}))),l&&l.length>0&&r.createElement("div",{className:"mt-3"},r.createElement("div",{className:"card border-secondary"},r.createElement("div",{className:"card-header py-2"},r.createElement("h6",{className:"mb-0 small"},"Integrated vendor inventory availability")),r.createElement("div",{className:"card-body p-2"},s?r.createElement("div",{className:"text-center py-2"},r.createElement("div",{className:"spinner-border spinner-border-sm text-primary",role:"status"},r.createElement("span",{className:"visually-hidden"},"Loading...")),r.createElement("span",{className:"ms-2 small text-muted"},"Loading inventory...")):r.createElement("div",{className:"table-responsive"},r.createElement("table",{className:"table table-sm table-hover table-striped mb-0"},r.createElement("thead",null,r.createElement("tr",null,r.createElement("th",null,"Company"),r.createElement("th",null,"Location"),r.createElement("th",null,"Qty"),r.createElement("th",{style:{width:"80px"}},"Action"))),r.createElement("tbody",null,l.map(function(e,t){return r.createElement("tr",{key:t},r.createElement("td",{className:"fw-bold"},(e.company||"").toUpperCase()),r.createElement("td",null,e.loc||""),r.createElement("td",null,e.qty||0),r.createElement("td",null,r.createElement("button",{className:"btn btn-sm btn-primary",onClick:function(){return m((e.company||"").toUpperCase())}},"Use")))})))))))))},A=function(e){var t=e.value,n=e.onChange,a=e.onPartSelect,c=e.api_call,o=e.readonly,l=g((0,r.useState)(t),2),s=l[0],i=l[1],u=g((0,r.useState)([]),2),m=u[0],d=u[1],f=g((0,r.useState)(!1),2),v=f[0],b=f[1],h=g((0,r.useState)(!1),2),y=(h[0],h[1]);(0,r.useEffect)(function(){i(t)},[t]);var N=function(){var e=E(p().m(function e(t){var n;return p().w(function(e){for(;;)switch(e.n){case 0:if(!(t.length<2)){e.n=1;break}return d([]),e.a(2);case 1:return y(!0),e.n=2,c("list","JADVDATA_dbo_part_meta",{return_columns:["part","inventory_description"],order:[{column:0,dir:"asc"}],columns:[{name:"part"},{name:"inventory_description"}],filters:{part:{operator:"ilike",value:t}}});case 2:(n=e.v).success&&n.data&&d(n.data.slice(0,20)),y(!1);case 3:return e.a(2)}},e)}));return function(t){return e.apply(this,arguments)}}();return(0,r.useEffect)(function(){var e=setTimeout(function(){s&&s!==t&&N(s)},300);return function(){return clearTimeout(e)}},[s]),r.createElement("div",{className:"position-relative"},r.createElement("input",{type:"text",className:"form-control form-control-sm",value:s,onChange:function(e){i(e.target.value),n(e.target.value),b(!0)},onFocus:function(){return b(!0)},onBlur:function(){return setTimeout(function(){return b(!1)},200)},placeholder:"Search...",readOnly:o}),v&&m.length>0&&r.createElement("div",{className:"position-absolute top-100 start-0 w-100 bg-white border rounded shadow-sm mt-1",style:{maxHeight:"200px",overflowY:"auto",zIndex:1050}},m.map(function(e){return r.createElement("div",{key:e.part,className:"p-2 hover-bg-light cursor-pointer",onClick:function(){a(e),i(e.part),b(!1)}},e.part," - ",e.inventory_description)})))},P=function(e){var t=e.lines,n=e.onClose,a=e.onReceive,c=g((0,r.useState)(new Set),2),o=c[0],l=c[1],s=t.map(function(e,t){return{line:e,index:t}}).filter(function(e){var t=e.line;return 0===parseFloat(t.rqty||t.received_qty||0)});return 0===s.length?r.createElement("div",{className:"modal d-block",style:{backgroundColor:"rgba(0,0,0,0.5)"}},r.createElement("div",{className:"modal-dialog"},r.createElement("div",{className:"modal-content"},r.createElement("div",{className:"modal-header"},r.createElement("h5",{className:"modal-title"},"Receive Purchase Order Lines"),r.createElement("button",{type:"button",className:"btn-close",onClick:n})),r.createElement("div",{className:"modal-body"},r.createElement("p",{className:"text-muted"},"All lines have been received.")),r.createElement("div",{className:"modal-footer"},r.createElement("button",{type:"button",className:"btn btn-secondary",onClick:n},"Close"))))):r.createElement("div",{className:"modal d-block",style:{backgroundColor:"rgba(0,0,0,0.5)"}},r.createElement("div",{className:"modal-dialog modal-lg"},r.createElement("div",{className:"modal-content"},r.createElement("div",{className:"modal-header"},r.createElement("h5",{className:"modal-title"},"Receive Purchase Order Lines"),r.createElement("button",{type:"button",className:"btn-close",onClick:n})),r.createElement("div",{className:"modal-body"},r.createElement("p",{className:"text-muted"},"Select which lines to receive. Each selected line will be fully received."),r.createElement("div",{className:"table-responsive"},r.createElement("table",{className:"table"},r.createElement("thead",null,r.createElement("tr",null,r.createElement("th",{width:"50"},r.createElement("input",{type:"checkbox",className:"form-check-input",checked:o.size===s.length,onChange:function(){o.size===s.length?l(new Set):l(new Set(s.map(function(e){return e.index})))}})),r.createElement("th",null,"Line"),r.createElement("th",null,"Part"),r.createElement("th",null,"Description"),r.createElement("th",null,"Quantity"))),r.createElement("tbody",null,s.map(function(e){var t=e.line,n=e.index;return r.createElement("tr",{key:n},r.createElement("td",null,r.createElement("input",{type:"checkbox",className:"form-check-input",checked:o.has(n),onChange:function(){return function(e){var t=new Set(o);t.has(e)?t.delete(e):t.add(e),l(t)}(n)}})),r.createElement("td",null,n+1),r.createElement("td",null,t.pcode||t.part||""),r.createElement("td",null,t.pdesc||t.description||""),r.createElement("td",null,t.pqty||t.quantity||0))}))))),r.createElement("div",{className:"modal-footer"},r.createElement("button",{type:"button",className:"btn btn-secondary",onClick:n},"Cancel"),r.createElement("button",{type:"button",className:"btn btn-primary",onClick:function(){return a(Array.from(o))},disabled:0===o.size},"Receive Selected Lines (",o.size,")")))))};function q(e){return e.lines&&(e.lines=e.lines.map(function(e){if(e.msg){var t=e.msg.split("\0")[0].trim();e.msg=t}return["gla","gldpta","tskcod","cat"].forEach(function(t){e[t]&&"string"==typeof e[t]&&(e[t]=e[t].replace(/\x00/g,"").trim())}),e})),{header:e.header||{},lines:e.lines||[],source_info:e.source_info||{}}}function j(e){return{vendor_code:e.vndcod||e.vendor_code||"",vendor_name:e.vndnme||e.vendor_name||"",order_date:F(e.orddte||e.order_date),expected_receipt_date:F(e.erd||e.expected_receipt_date),location:e.loc||e.location||"TAC",entered_by:e.entby||e.entered_by||"",terms:e.termd||e.terms||"",ship_via:e.shpvia||e.ship_via||"UPS",freight:parseFloat(e.frght||e.freight||0),subtotal:parseFloat(e.subtot||e.subtotal||0),tax_amount:parseFloat(e.taxamt||e.tax_amount||0),total:parseFloat(e.total||0),printed:"Y"===e.prtd||e.printed||!1,orderd_by_customer:e.obycus||"",billing:{name:e.vndnme||e.vendor_name||"",address1:e.vnda1||"",address2:e.vnda2||"",city:e.vndcty||"",state:e.vndst||"",zip:e.vndzip||"",country:e.vndctry||"USA"},shipping:{name:e.shpnme||"",attention:e.shpatn||"",address1:e.shpa1||"",address2:e.shpa2||"",city:e.shpcty||"",state:e.shpst||"",zip:e.shpzip||"",country:e.shpctry||"USA"}}}function F(e){if(!e)return"";if("string"==typeof e)return e;if(e.year&&e.month&&e.day){var t=e.year,n=String(e.month).padStart(2,"0"),r=String(e.day).padStart(2,"0");return"".concat(t,"-").concat(n,"-").concat(r)}return""}if("undefined"!=typeof document){var I=document.createElement("style");I.textContent="\n    .hover-bg-light:hover {\n        background-color: #f8f9fa;\n    }\n    .cursor-pointer {\n        cursor: pointer;\n    }\n",document.head.appendChild(I)}const T=function(e){var t=e.config,n=g((0,r.useState)(!1),2),i=n[0],u=n[1],m=g((0,r.useState)(""),2),f=m[0],v=m[1],y=g((0,r.useState)(t.po_number||null),1)[0],N=g((0,r.useState)(!!t.po_number&&"NEW"!==t.po_number),1)[0],_=g((0,r.useState)(null),2),A=(_[0],_[1]),F=(0,r.useState)(function(e){var t=(new Date).toISOString().split("T")[0],n=new Date;return n.setDate(n.getDate()+2),{vendor_code:"",vendor_name:"",order_date:t,expected_receipt_date:n.toISOString().split("T")[0],location:e.location||"TAC",entered_by:"",orderd_by_customer:"",terms:"",ship_via:"UPS",freight:0,subtotal:0,tax_amount:0,total:0,printed:!1,billing:{name:"",address1:"",address2:"",city:"",state:"",zip:"",country:"USA"},shipping:{name:"",attention:"",address1:"",address2:"",city:"",state:"",zip:"",country:"USA"}}}(t)),I=g(F,2),T=I[0],D=I[1],z=g((0,r.useState)([]),2),L=z[0],U=z[1],B=g((0,r.useState)([]),2),R=B[0],V=B[1],G=g((0,r.useState)({show:!1,comments1:"",comments2:""}),2),K=G[0],$=G[1],H=g((0,r.useState)(!1),2),M=H[0],Y=H[1],J=g((0,r.useState)(new Set),2),Q=(J[0],J[1],g((0,r.useState)({}),2)),W=Q[0],X=Q[1],Z=g((0,r.useState)({}),2),ee=Z[0],te=Z[1],ne=t.pre_populate_data||{location:t.location,ship_via:t.ship_via,shipping_address:t.shipping_address,initial_items:t.initial_items||[],vendors:t.vendors||!1,parked_order_id:t.parked_order_id||0},re=function(){var e=E(p().m(function e(n,r){var a,c,o=arguments;return p().w(function(e){for(;;)switch(e.n){case 0:return a=o.length>2&&void 0!==o[2]?o[2]:{},c=b({operation:n,model:r,company:t.company||"PACIFIC"},a),e.n=1,window.app.api.post(t.data_api,c);case 1:return e.a(2,e.v)}},e)}));return function(t,n){return e.apply(this,arguments)}}();(0,r.useEffect)(function(){var e=function(){var e=E(p().m(function e(){return p().w(function(e){for(;;)switch(e.n){case 0:if("NEW"!==t.po_number){e.n=1;break}ce(),0===ne.initial_items.length&&se(),e.n=4;break;case 1:if(!N){e.n=3;break}return e.n=2,ae();case 2:e.n=4;break;case 3:se();case 4:return e.a(2)}},e)}));return function(){return e.apply(this,arguments)}}();e()},[]);var ae=function(){var e=E(p().m(function e(){var t,n;return p().w(function(e){for(;;)switch(e.n){case 0:return u(!0),v("Loading purchase order..."),e.n=1,re("get","PurchaseOrder",{po_number:y});case 1:if(!(t=e.v).success){e.n=3;break}if(n=q(t),D(j(n.header||{})),U(n.lines||[]),!n.header.vendor_code){e.n=2;break}return e.n=2,le(n.header.vendor_code);case 2:e.n=4;break;case 3:be("Failed to load purchase order");case 4:u(!1);case 5:return e.a(2)}},e)}));return function(){return e.apply(this,arguments)}}(),ce=function(){var e=ne;if(e.location&&D(function(t){return b(b({},t),{},{location:e.location})}),e.ship_via&&D(function(t){return b(b({},t),{},{ship_via:e.ship_via})}),e.shipping_address&&D(function(t){return b(b({},t),{},{shipping:b(b({},t.shipping),e.shipping_address)})}),e.initial_items&&e.initial_items.length>0){var t=e.initial_items.map(function(e){return"part"===e.type&&e.part?{_source:"active",part:e.part,pcode:e.part,description:e.description||"",pdesc:e.description||"",quantity:e.qty||1,pqty:e.qty||1,price:e.price||0,pprce:e.price||0,discount:0,pdisc:0,extended:(e.price||0)*(e.qty||1),pext:(e.price||0)*(e.qty||1),received_qty:0,rqty:0,erd:T.expected_receipt_date,type:"R",taxable:!1,message:"",msg:""}:"note"===e.type&&e.message?{_source:"active",type:"N",message:e.message,msg:e.message,part:"",pcode:"",description:"",pdesc:"",quantity:0,pqty:0,price:0,pprce:0,discount:0,pdisc:0,extended:0,pext:0,received_qty:0,rqty:0,erd:T.expected_receipt_date,taxable:!1}:null}).filter(Boolean);U(t),t.forEach(function(e,t){e.part&&me(e.part,t)})}},oe=function(){var e=E(p().m(function e(t){return p().w(function(e){for(;;)switch(e.n){case 0:A(t),D(function(e){return b(b({},e),{},{vendor_code:t.code,vendor_name:t.name,billing:{name:t.name,address1:t.add1||"",address2:t.add2||"",city:t.city||"",state:t.state||"",zip:t.zip_||"",country:t.country||"USA"},terms:t.terms_num||e.terms})}),t.comments1||t.comments2?$({show:!0,comments1:t.comments1||"",comments2:t.comments2||""}):$({show:!1,comments1:"",comments2:""});case 1:return e.a(2)}},e)}));return function(t){return e.apply(this,arguments)}}(),le=function(){var e=E(p().m(function e(t){var n;return p().w(function(e){for(;;)switch(e.n){case 0:return e.n=1,re("list","GPACIFIC_dbo_BKAPVEND",{filters:{code:{operator:"eq",value:t}},start:0,length:1});case 1:if(!((n=e.v).success&&n.data&&n.data.length>0)){e.n=2;break}return e.n=2,oe(n.data[0]);case 2:return e.a(2)}},e)}));return function(t){return e.apply(this,arguments)}}(),se=function(){var e={_source:"active",part:"",pcode:"",description:"",pdesc:"",quantity:1,pqty:1,price:0,pprce:0,discount:0,pdisc:0,extended:0,pext:0,received_qty:0,rqty:0,erd:T.expected_receipt_date,type:"R",taxable:!1,message:"",msg:""};U(function(t){return[].concat(d(t),[e])})},ie=function(e){var t=L[e];t.rqty>0?be("Cannot remove received lines"):confirm("Remove this line?")&&(t.record&&V(function(e){return[].concat(d(e),[t.record])}),U(function(t){return t.filter(function(t,n){return n!==e})}))},ue=function(e,t,n){U(function(r){var a=d(r),c=b({},a[e]);c[t]=n;var o={part:"pcode",description:"pdesc",quantity:"pqty",price:"pprce",discount:"pdisc",message:"msg"};if(o[t]&&(c[o[t]]=n),"N"!==c.type&&["quantity","price","discount"].includes(t)){var l=parseFloat(c.quantity||c.pqty||0)*(parseFloat(c.price||c.pprce||0)-parseFloat(c.discount||c.pdisc||0));c.extended=l,c.pext=l}return a[e]=c,a})},me=function(){var e=E(p().m(function e(t,n){var r;return p().w(function(e){for(;;)switch(e.n){case 0:if(t){e.n=1;break}return e.a(2);case 1:return te(function(e){return b(b({},e),{},h({},n,!0))}),e.n=2,re("list","JADVDATA_dbo_virtual_inventory",{filters:{part:{operator:"eq",value:t}},start:0,length:50});case 2:(r=e.v).success&&r.data&&r.data.length>0?X(function(e){return b(b({},e),{},h({},n,r.data))}):X(function(e){return b(b({},e),{},h({},n,[]))}),te(function(e){return b(b({},e),{},h({},n,!1))});case 3:return e.a(2)}},e)}));return function(t,n){return e.apply(this,arguments)}}(),de=function(){var e=E(p().m(function e(t,n){var r;return p().w(function(e){for(;;)switch(e.n){case 0:if(!(ne.vendors&&ne.vendors.length>0)){e.n=2;break}if(!(r=ne.vendors.find(function(e){return e.code===t}))){e.n=2;break}return e.n=1,oe(r);case 1:case 3:return e.a(2);case 2:return e.n=3,le(t)}},e)}));return function(t,n){return e.apply(this,arguments)}}(),pe=function(){var e=E(p().m(function e(){var t,n,r;return p().w(function(e){for(;;)switch(e.n){case 0:if(ve()){e.n=1;break}return e.a(2);case 1:return u(!0),v("Saving purchase order..."),t={header:T,lines:L,deleted_line_ids:R},N&&(t.po_number=y),n=N?"update":"create",e.n=2,re(n,"PurchaseOrder",{data:t});case 2:if(!(r=e.v).success){e.n=5;break}if(he("Purchase order saved successfully!"),N||!r.data.po_number){e.n=3;break}window.location.href="/purchase_orders/edit/".concat(r.data.po_number),e.n=4;break;case 3:return e.n=4,ae();case 4:V([]),e.n=6;break;case 5:be(r.message||"Failed to save purchase order");case 6:u(!1);case 7:return e.a(2)}},e)}));return function(){return e.apply(this,arguments)}}(),fe=(0,r.useMemo)(function(){var e=0;L.forEach(function(t){var n=parseFloat(t.extended||t.pext||0);e+=n});var t=parseFloat(T.freight||0),n=parseFloat(T.tax_amount||0);return{subtotal:e,freight:t,tax_amount:n,total:e+t+n}},[L,T.freight,T.tax_amount]),ve=function(){var e=[];T.vendor_code||e.push("Please select a vendor"),T.order_date||e.push("Order date is required"),T.expected_receipt_date||e.push("Expected receipt date is required"),0===L.length&&e.push("At least one line item is required");var t=!1;return L.forEach(function(e){var n=e.part||e.pcode,r=parseFloat(e.quantity||e.pqty||0);n&&r>0&&(t=!0)}),t||e.push("At least one line must have a part and quantity"),!(e.length>0&&(be("Please fix the following errors:\n"+e.join("\n")),1))},be=function(e){alert("Error: "+e)},he=function(e){alert("Success: "+e)},ye=!L.some(function(e){return e.rqty>0});return r.createElement("div",{className:"container-fluid mt-3"},i&&r.createElement("div",{className:"position-fixed top-0 start-0 w-100 h-100 d-flex align-items-center justify-content-center",style:{background:"rgba(0,0,0,0.5)",zIndex:9999}},r.createElement("div",{className:"text-center text-white"},r.createElement("div",{className:"spinner-border text-light mb-2",role:"status"},r.createElement("span",{className:"visually-hidden"},"Loading...")),r.createElement("div",null,f||"Loading..."))),r.createElement("h4",{className:"mb-3"},"Purchase Order",y&&r.createElement("span",{className:"ms-2"},"#",y),T.printed&&r.createElement("span",{className:"badge bg-success ms-2"},"Printed")),r.createElement("div",{className:"row g-3"},r.createElement("div",{className:"col-lg-6 mb-3"},r.createElement("div",{className:"card h-100"},r.createElement("div",{className:"card-header"},r.createElement("h6",{className:"mb-0"},"Order Details")),r.createElement("div",{className:"card-body"},r.createElement("div",{className:"row g-2"},r.createElement("div",{className:"col-md-6"},r.createElement("label",{className:"form-label"},"Vendor ",r.createElement("span",{className:"text-danger"},"*")),r.createElement(x,{value:T.vendor_code,vendors:ne.vendors,onVendorChange:oe,api_call:re,disabled:!ye})),r.createElement("div",{className:"col-md-6"},r.createElement("label",{className:"form-label"},"Ordered By"),r.createElement("input",{type:"text",className:"form-control form-control-sm",value:T.orderd_by_customer||"",onChange:function(e){return D(function(t){return b(b({},t),{},{orderd_by_customer:e.target.value})})},placeholder:"Name..."})),r.createElement("div",{className:"col-md-6"},r.createElement("label",{className:"form-label"},"Order Date ",r.createElement("span",{className:"text-danger"},"*")),r.createElement("input",{type:"date",className:"form-control form-control-sm",value:T.order_date,onChange:function(e){return D(function(t){return b(b({},t),{},{order_date:e.target.value})})},disabled:!ye,required:!0})),r.createElement("div",{className:"col-md-6"},r.createElement("label",{className:"form-label"},"Expected Date ",r.createElement("span",{className:"text-danger"},"*")),r.createElement("input",{type:"date",className:"form-control form-control-sm",value:T.expected_receipt_date,onChange:function(e){return D(function(t){return b(b({},t),{},{expected_receipt_date:e.target.value})})},required:!0})))))),r.createElement("div",{className:"col-lg-6 mb-3"},r.createElement("div",{className:"card h-100"},r.createElement("div",{className:"card-header"},r.createElement("h6",{className:"mb-0"},"Shipping Details")),r.createElement("div",{className:"card-body"},r.createElement("div",{className:"row g-2"},r.createElement("div",{className:"col-md-4"},r.createElement("label",{className:"form-label"},"Terms"),r.createElement(w,{value:T.terms,onChange:function(e){return D(function(t){return b(b({},t),{},{terms:e})})},api_call:re,disabled:!ye})),r.createElement("div",{className:"col-md-4"},r.createElement("label",{className:"form-label"},"Ship Via"),r.createElement(S,{value:T.ship_via,onChange:function(e){return D(function(t){return b(b({},t),{},{ship_via:e})})},api_call:re,disabled:!ye})),r.createElement("div",{className:"col-md-4"},r.createElement("label",{className:"form-label"},"Freight"),r.createElement("input",{type:"number",className:"form-control form-control-sm",value:T.freight,onChange:function(e){return D(function(t){return b(b({},t),{},{freight:parseFloat(e.target.value)||0})})},min:"0",step:"0.01"})),r.createElement("div",{className:"col-md-12"},r.createElement("label",{className:"form-label"},"Location"),r.createElement(C,{value:T.location,onChange:function(e){return D(function(t){return b(b({},t),{},{location:e})})},api_call:re,company:t.company}))))))),K.show&&r.createElement("div",{className:"alert alert-warning"},r.createElement("h6",{className:"alert-heading"},"Vendor Notes:"),K.comments1&&r.createElement("p",{className:"mb-2"},K.comments1),K.comments2&&r.createElement("p",{className:"mb-0"},K.comments2)),r.createElement("div",{className:"row g-3 mb-3"},r.createElement("div",{className:"col-lg-6"},r.createElement(k,{title:"Billing Address",address:T.billing,onChange:function(e){return D(function(t){return b(b({},t),{},{billing:e})})},readonly:!ye})),r.createElement("div",{className:"col-lg-6"},r.createElement(k,{title:"Shipping Address",address:T.shipping,onChange:function(e){return D(function(t){return b(b({},t),{},{shipping:e})})},showCopyButton:!0,onCopy:function(){return D(function(e){return b(b({},e),{},{shipping:b(b({},e.billing),{},{attention:e.shipping.attention})})})}}))),r.createElement("div",{className:"card mb-3"},r.createElement("div",{className:"card-header d-flex justify-content-between align-items-center"},r.createElement("h6",{className:"mb-0"},"Line Items"),r.createElement("div",null,r.createElement("button",{className:"btn btn-primary btn-sm me-2",onClick:se},r.createElement(a.A,{size:16,className:"me-1"}),"Add Line"),r.createElement("button",{className:"btn btn-secondary btn-sm",onClick:function(){var e={_source:"active",type:"N",message:"",msg:"",part:"",pcode:"",description:"",pdesc:"",quantity:0,pqty:0,price:0,pprce:0,discount:0,pdisc:0,extended:0,pext:0,received_qty:0,rqty:0,erd:T.expected_receipt_date,taxable:!1};U(function(t){return[].concat(d(t),[e])})}},r.createElement(c.A,{size:16,className:"me-1"}),"Add Note"))),r.createElement("div",{className:"card-body"},0===L.length?r.createElement("div",{className:"text-muted text-center p-4"},'No lines added. Click "Add Line" to start.'):L.map(function(e,t){return r.createElement(O,{key:t,line:e,index:t,onUpdate:ue,onRemove:ie,api_call:re,virtualInventory:W[t],inventoryLoading:ee[t],onFetchInventory:function(e){return me(e,t)},onSelectVendor:function(e){return de(e,t)}})}))),r.createElement("div",{className:"row mb-3"},r.createElement("div",{className:"col-md-4 offset-md-8"},r.createElement("div",{className:"card"},r.createElement("div",{className:"card-body"},r.createElement("div",{className:"d-flex justify-content-between mb-2"},r.createElement("span",null,"Subtotal:"),r.createElement("strong",null,"$",fe.subtotal.toFixed(2))),r.createElement("div",{className:"d-flex justify-content-between mb-2"},r.createElement("span",null,"Tax:"),r.createElement("strong",null,"$",fe.tax_amount.toFixed(2))),r.createElement("div",{className:"d-flex justify-content-between mb-2"},r.createElement("span",null,"Freight:"),r.createElement("strong",null,"$",fe.freight.toFixed(2))),r.createElement("hr",null),r.createElement("div",{className:"d-flex justify-content-between"},r.createElement("span",{className:"h5"},"Total:"),r.createElement("strong",{className:"h5"},"$",fe.total.toFixed(2))))))),r.createElement("div",{className:"mb-4"},r.createElement("button",{className:"btn btn-success me-2",onClick:pe,disabled:i},r.createElement(o.A,{size:16,className:"me-1"}),N?"Update PO":"Create PO"),N&&r.createElement("button",{className:"btn btn-primary me-2",onClick:function(){return Y(!0)}},r.createElement(l.A,{size:16,className:"me-1"}),"Receive"),r.createElement("button",{className:"btn btn-secondary",onClick:function(){return window.location.href="/purchase_orders"}},r.createElement(s.A,{size:16,className:"me-1"}),"Cancel")),M&&r.createElement(P,{lines:L,onClose:function(){return Y(!1)},onReceive:function(){var e=E(p().m(function e(t){var n;return p().w(function(e){for(;;)switch(e.n){case 0:return u(!0),v("Processing receipt..."),e.n=1,re("update","PurchaseOrder",{po_number:y,action:"receive_lines",line_indices:t});case 1:if(!(n=e.v).success){e.n=3;break}return he("Successfully received ".concat(t.length," line(s)")),e.n=2,ae();case 2:e.n=4;break;case 3:be(n.message||"Failed to process receipt");case 4:u(!1),Y(!1);case 5:return e.a(2)}},e)}));return function(t){return e.apply(this,arguments)}}()}))}}},n={};function r(e){var a=n[e];if(void 0!==a)return a.exports;var c=n[e]={exports:{}};return t[e](c,c.exports,r),c.exports}r.m=t,e=[],r.O=(t,n,a,c)=>{if(!n){var o=1/0;for(u=0;u<e.length;u++){for(var[n,a,c]=e[u],l=!0,s=0;s<n.length;s++)(!1&c||o>=c)&&Object.keys(r.O).every(e=>r.O[e](n[s]))?n.splice(s--,1):(l=!1,c<o&&(o=c));if(l){e.splice(u--,1);var i=a();void 0!==i&&(t=i)}}return t}c=c||0;for(var u=e.length;u>0&&e[u-1][2]>c;u--)e[u]=e[u-1];e[u]=[n,a,c]},r.d=(e,t)=>{for(var n in t)r.o(t,n)&&!r.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},r.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),r.j=820,(()=>{var e={820:0};r.O.j=t=>0===e[t];var t=(t,n)=>{var a,c,[o,l,s]=n,i=0;if(o.some(t=>0!==e[t])){for(a in l)r.o(l,a)&&(r.m[a]=l[a]);if(s)var u=s(r)}for(t&&t(n);i<o.length;i++)c=o[i],r.o(e,c)&&e[c]&&e[c][0](),e[c]=0;return r.O(u)},n=self.webpackChunkreact_app=self.webpackChunkreact_app||[];n.forEach(t.bind(null,0)),n.push=t.bind(null,n.push.bind(n))})();var a=r.O(void 0,[184],()=>r(165));return(a=r.O(a)).default})());
//# sourceMappingURL=PurchaseOrderBuilder.bundle.js.map